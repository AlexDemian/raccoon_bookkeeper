{% extends 'base.html' %}
{% block content %}

<style>


    #child_container {
        position: absolute;
        top: 80px;
        margin-left: 200px;
        width: 88%;
        height: 90%;
        overflow-y: scroll;
    }

    .sheet-container {
        margin-bottom: 100px;
        min-height: 500px;
        padding-top: 10px;


    }

    .chart-container {
        display: inline-block;
        position: absolute;
        margin-left: 70px;
        height: 350px;
        width: 350px;
    }


     .table-container {
         width: 70%;
         display: inline-block;
     }

    #menu_container {
        position: absolute;
        top: 50px;
        width: 150px;
        height: calc(100% - 50px);
        background-color: var(--sec-bg-color);
        color: white;
        border-right: 2px solid black;
        box-shadow: 2px 0px 5px gray;
        font-weight: 500;
        font-size: 14px;
    }

    .right-menu-field {
        margin-top: 5px;
        margin-right: 5px;
        margin-left: 5px;
    }

    .horizontal-separator {
        background-color:#ed9c33;
        height: 2px;
        width: 100%;
        box-shadow: 0px 3px 5px #edcd84;

    }


    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
    }



</style>


<div id="menu_container" align="center">
    <br>
    <form id="filters_form">
        <input type="hidden" name="target" value="sheets_ids">
        Sheet filters:
        <div class="right-menu-field">{{ filter_sheet_form["filter_sheetbase_name"] }}</div>
        <div class="right-menu-field">{{ filter_sheet_form["filter_date_from"] }}</div>
        <div class="right-menu-field">{{ filter_sheet_form["filter_date_to"] }}</div>

        <button class="nav-button btn yellow-button" style="margin-top: 10px" type="button" onclick="get_all_sheets()">Filter</button>
    </form>
    <br>
    <div class="horizontal-separator"></div>
    <br>
    <form id="add_sheet_form">
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
        <input type="hidden" name="action" value="add">

        Add sheet:
        <div class="right-menu-field">{{  add_sheet_form["add_sheetbase_id"] }}</div>
        <div class="right-menu-field">{{  add_sheet_form["add_sheet_date"] }}</div>

        <button class="nav-button btn yellow-button"  style="margin-top: 10px" type="button"  onclick="add_sheet()">Add</button>
    </form>
    <br>
    <div class="horizontal-separator"></div>
    <br>
    Calculator:
    {% include 'booker/calc.html' %}
    <br>
    <div class="horizontal-separator"></div>
    <br>

</div>

<div id="child_container"></div>


<script>


    function get(url, args, result_to) {
        $.get(url, args)
            .done(function( data ) {
                result_to.html(data);
        });
    }

    function get_all_sheets() {
        args = $('#filters_form').serialize();
        get('booker/api_sheets', args, $('#child_container'));
    }


    function add_sheet() {

        $.post('booker/create_sheet', $('#add_sheet_form').serializeArray())
            .done(function( data ) {
                if (!data.status) {
                alert(data.message);
                } else {
                    get_all_sheets();
                }
        });

    }

    $(".select2_bootstrap").select2();
    get_all_sheets();




</script>


{% endblock %}
{% extends 'base.html' %}
{% block content %}

<style>


    #child_container {
        position: absolute;
        top: 150px;
        margin-left: 200px;
        width: 88%;
        height: 80%;
        overflow-y: scroll;
    }

    .sheet-container {
        margin-bottom: 100px;
        min-height: 500px;
        padding-top: 10px;


    }

    .chart-container {
        display: inline-block;
        position: absolute;
        margin-left: 70px;
        height: 350px;
        width: 350px;
    }


     .table-container {
         width: 70%;
         display: inline-block;
     }

    #menu_container {
        position: absolute;
        top: 50px;
        width: 150px;
        height: calc(100% - 50px);
        background-color: var(--sec-bg-color);
        color: white;
        border-right: 2px solid black;
        box-shadow: 2px 0px 5px gray;
    }

    .right-menu-field {
        margin-top: 5px;
        margin-right: 5px;
        margin-left: 5px;
    }

    .horizontal-separator {
        background-color:#ed9c33;
        height: 2px;
        width: 100%;
        box-shadow: 0px 3px 5px #edcd84;

    }


    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
    }



</style>






<div id="menu_container" align="center">


    <form id="filters_form">
        <input type="hidden" name="target" value="sheets_ids">
        Sheet filters:
        {% for field in filter_form %}
            <div class="right-menu-field">{{ field }}</div>
        {% endfor %}
        <button class="nav-button yellow-button round-button" type="button" onclick="get_all_sheets()">Filter it!</button>
    </form>
    <br>
    <div class="horizontal-separator"></div>
    <br>
    <form id="add_sheet_form">
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
        <input type="hidden" name="action" value="add">
        Add sheet:
        {% for field in add_sheet_form %}
            <div class="right-menu-field">{{ field }}</div>
        {% endfor %}
        <button class="nav-button yellow-button round-button"  type="button"  onclick="add_sheet()">Add!</button>
    </form>
    <br>
    <div class="horizontal-separator"></div>
    <br>
    {% include 'booker/calc.html' %}
    <br>
    <div class="horizontal-separator"></div>
    <br>
    <button class="nav-button yellow-button round-button"  type="button"  onclick="showHideGpaphs();">Show/hide charts</button>
    <br>
</div>

<div id="child_container"></div>


<script>


    function get(url, args, result_to) {
        $.get(url, args)
            .done(function( data ) {
                result_to.html(data);
        });
    }

    function get_all_sheets() {
        args = $('#filters_form').serialize();
        get('booker/api_sheets', args, $('#child_container'));
    }

    function add_category() {
        $.post('booker/api_categories', $('#add_category_form').serializeArray())
        .done(function( data ) {
            if (!data.status) {
            alert(data.message);
            }
        });
    }


    function add_sheet() {

        $.post('booker/api_sheets', $('#add_sheet_form').serializeArray())
            .done(function( data ) {
                if (!data.status) {
                alert(data.message);
                } else {
                    get_all_sheets();
                }
        });

    }

    $(".select2_bootstrap").select2();
    get_all_sheets();

    window.show_charts = true;
    Vue.prototype.show_charts = window.show_charts;

    function showHideGpaphs() {
        window.show_charts = !window.show_charts;
        Vue.prototype.show_charts = window.show_charts;
    }



</script>


{% endblock %}